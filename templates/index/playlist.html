{% load static %}
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Ansiant Beatstore</title>
    <link rel="stylesheet" type="text/css" href="{% static 'css/playlist.css' %}" />
    <link rel="shortcut icon" href="{% static 'images/logo.png' %}" type="image/x-icon" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/animate.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/icono.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/player.css' %}">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script>
        window.onload = function () {
            document.body.classList.add('loaded_hiding');
            window.setTimeout(function () {
                document.body.classList.add('loaded');
                document.body.classList.remove('loaded_hiding');
            }, 500);
        }
    </script>
</head>

<body>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <div class="card-container">
        <div class="right-header-cart">
            <div class="header-cart-img" onclick="window.location='{% url 'shop_cart' %}'">
                <img src="{% static 'images/purchase2.png' %}" alt="">
            </div>
            <div class="right-header-cart-text">
                <p>${{ amount }}</p>
            </div>
        </div>
    </div>

    {% include 'basic/sidebar.html' %}

    <div class="mobile-filter-menu" id="filter-menu">
        <div class="mobile-filter__item">
            <div class="mobile-filter__title">
                <p>
                    Sort & Filter
                </p>
            </div>
            <div class="mobile-filter__content">
                <div class="filter-content">
                    <button class="scale button-active" id="button-main1" onclick="changeColorFilter(this)" data-filter-value="all">ALL</button>
                    <button class='teg-btn' id="button1" onclick="changeColorFilter(this)" data-filter-value="new">NEW</button>
                    <button class='teg-btn' id="button1" onclick="changeColorFilter(this)" data-filter-value="gold">GOLD</button>
                </div>
            </div>
        </div>
        
        <div class="mobile-filter__item">
            <div class="mobile-filter__title">
                <p>
                    Categories
                </p>
            </div>
            <div class="mobile-filter__content">
                <div class="filter-content">
                    <div class="dropdown-container">
                        <div class="dropdown-menu">
                            <button class="dropbtn">NEWEST 🢓</button>
                            <div class="dropdown-content">
                                <a href="#">price ascending</a>
                                <a href="#">price descending</a>
                            </div>
                        </div>

                        <div class="dropdown-menu" data-filter-type="mood">
                            <button class="dropbtn">MOOD 🢓</button>
                            <div class="dropdown-content">
                                {% for mood in mood %}
                                    <a href="#" class="filter-option" data-filter-value="{{ mood.id }}">{{ mood.title }}</a>
                                {% endfor %}
                            </div>
                        </div>

                        <div class="dropdown-menu">
                            <button class="dropbtn">KEY 🢓</button>
                            <div class="dropdown-content">
                                {% for key in key %}
                                    <a href="#" class="filter-option" data-filter-value="{{ key.id }}">{{ key.title }}</a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="mobile-filter__item">
            <div class="mobile-filter__title">
                <p>
                    Price
                </p>
            </div>
            <div class="mobile-filter__content">
                <div class="filter-content">
                    <div class="bpm-filter">
                        <div class="title-filter">
                            <p>Price</p>
                        </div>
                        <div class="filter-range-content">
                            <div class="rangeslider">
                                <input class="min2" name="range_1" type="range" min="65" max="500" value="65">
                                <input class="max2" name="range_1" type="range" min="65" max="500" value="500">
                                <span class="range_min2 light left">65 $</span>
                                <span class="range_max2 light right">500 $</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="mobile-filter__item">
            <div class="mobile-filter__title">
                <p>
                    Bpm
                </p>
            </div>
            <div class="mobile-filter__content">
                <div class="filter-content">
                    <div class="bpm-filter">
                        <div class="title-filter">
                            <p>Price</p>
                        </div>
                        <div class="filter-range-content">
                            <div class="rangeslider">
                                <input class="min" name="range_2" type="range" min="{{ min_bpm }}" max="{{ min_bmp }}" value="0" />
                                <input class="max" name="range_2" type="range" min="{{ min_bpm }} " max="{{ max_bpm }} " value="{{ max_bpm }}" />
                                <span class="range_min light left">{{ min_bpm }} bpm</span>
                                <span class="range_max light right">{{ max_bpm }} bpm</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="mobile-filter__item">
            <div class="mobile-filter__title">
                <p>
                    Genres
                </p>
            </div>
            <div class="mobile-filter__content">
                <div class="filter-content" style="display: block;">
                    <div class="buttons-container">
                        <button id="button-main" onclick="changeColorGenre(this)">ALL</button>
                        <button id="button" onclick="changeColorGenre(this)">DRILL</button>
                        <button id="button" onclick="changeColorGenre(this)">TRAP</button>
                        <button id="button" onclick="changeColorGenre(this)">LIRIC</button>
                        <button id="button" onclick="changeColorGenre(this)">LO-FI</button>
                    </div>
                    <div class="buttons-container">
                        <button id="button" onclick="changeColorGenre(this)">CLUB</button>
                        <button id="button" onclick="changeColorGenre(this)">BOOM BAP</button>
                        <button id="button" onclick="changeColorGenre(this)">HIP-HOP</button>
                        <button id="button" onclick="changeColorGenre(this)">PHONK</button>
                        <button id="button" onclick="changeColorGenre(this)">Slap House</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% include 'basic/header.html' %}
    <div class="main-container">
        <div class="preloader">
            <div class="preloader__row">
                <div class="preloader__item"></div>
                <div class="preloader__item"></div>
            </div>
        </div>

        <div class="filter-container">
            <div class="top-filter">
                <div class="news-filter">
                    <div class="title-filter">
                        <p>SORT & FILTER</p>
                    </div>
                    <div class="filter-content">
                        <button class="scale button-active" id="button-main1" onclick="changeColorFilter(this)" data-filter-value='all'>ALL</button>
                        <button class="scale" id="button1" onclick="changeColorFilter(this)" data-filter-value='new'>NEW</button>
                        <button class="scale" id="button1" onclick="changeColorFilter(this)" data-filter-value='gold'>GOLD</button>
                    </div>
                </div>
                
                <script>
                    $('body').on('click', '#button1, #button-main1', function(event) {
                            let filterType = 'teg';
                            let filterValue = this.getAttribute("data-filter-value");
        
                            $.ajax({
                                    url: '{% url 'filter' %}',
                                    type: 'POST',
                                    dataType: 'json',
                                    data: {
                                        'filterType': filterType,
                                        'filterValue': filterValue
                                    },
                                    success: function (response) {
                                        html = ''
                                        response.beats.forEach(function (beat) {
                                            html += '<div class="beat-item"> <div class="beat-img"> <img class="beat-img-cls" src="' + beat.cover + '" alt="">'
                                            html += '<div id="play-beat-container" class="play-beat-container" beat_id="' + beat.beat_id + '" beat="' + beat.beat + '" title="' + beat.title + '" cover="' + beat.cover + '" duration="' + beat.duration + '" isGold="' + beat.isGold + '">'
                                            html += '<img src="{% static 'images/play.png' %}" alt=""> </div> </div>'
                                            html += '<div class="title-beat"> <p id="title-beat">' + beat.title + '</p> <span>' + beat.type + '</span> </div>'
                                            html += '<div class="parametrs-beat">'
        
                                            let isNew = beat.isNew
                                            if(isNew) {
                                                html += '<div class="beat-parametr new"> <p>NEW</p> </div>'
                                            }
        
                                            let isGold = beat.isGold
                                            if(isGold){
                                                html += '<div class="beat-parametr premium"><p>Gold</p></div>'
                                            }
                                            html += '<div class="beat-parametr"> <p>' + beat.tonal + '</p> </div> <div class="beat-parametr"> <p>' + beat.bpm + ' bpm</p> </div> <div class="beat-parametr"> <p>' + beat.mood + '</p> </div>  </div>'
                                            html += '<div class="beat-elements"> <div class="beat-price"> <p>$' + beat.price + '</p> </div>'
        
                                            html += '<div class="button-to-card">';
                                            if (beat.isAddedToCart) {
                                                html += '<button id="delete-from-cart" beat_id="' + beat.beat_id + '">ADDED✓</button>';
                                            } else {
                                                html += '<button id="add-to-cart" beat_id="' + beat.beat_id + '">ADD TO CART</button>';
                                            }
                                            html += '</div></div></div>';
                                        })
                                        $('.beat-items-container').html(html)
                                    }
                                })
                            })
                </script>

                <div class="parametrs-filter-container">
                    <div class="title-filter">

                    </div>
                    <div class="dropdown-container">
                        <div class="dropdown-menu" data-filter-type="newest">
                            <button class="dropbtn">NEWEST 🢓</button>
                            <div class="dropdown-content">
                                <a href="#" class="filter-option" data-filter-value="ascending">price ascending</a>
                                <a href="#" class="filter-option" data-filter-value="descending">price descending</a>
                            </div>
                        </div>

                        <div class="dropdown-menu" data-filter-type="mood">
                            <button class="dropbtn">MOOD 🢓</button>
                            <div class="dropdown-content">
                                {% for mood in mood %}
                                    <a href="#" class="filter-option" data-filter-value="{{ mood.id }}">{{ mood.title }}</a>
                                {% endfor %}
                            </div>
                        </div>

                        <div class="dropdown-menu" data-filter-type="key">
                            <button class="dropbtn">KEY 🢓</button>
                            <div class="dropdown-content">
                                {% for key in key %}
                                    <a href="#" class="filter-option" data-filter-value="{{ key.id }}">{{ key.title }}</a>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                <script>
                    let filterOptions = document.getElementsByClassName("filter-option");

                    for (let i = 0; i < filterOptions.length; i++) {
                      filterOptions[i].addEventListener("click", function(event) {
                          event.preventDefault();
                          let parentMenu = this.closest(".dropdown-menu");
                          let filterType = parentMenu.getAttribute("data-filter-type");
                          let filterValue = this.getAttribute("data-filter-value");

                          $.ajax({
                                url: '{% url 'filter' %}',
                                type: 'POST',
                                dataType: 'json',
                                data: {
                                    'filterType': filterType,
                                    'filterValue': filterValue
                                },
                                success: function (response){
                                    html = ''
                                    response.beats.forEach(function (beat) {
                                        html += '<div class="beat-item"> <div class="beat-img"> <img class="beat-img-cls" src="' + beat.cover + '" alt="">'
                                        html += '<div id="play-beat-container" class="play-beat-container" beat_id="' + beat.beat_id + '" beat="' + beat.beat + '" title="' + beat.title + '" cover="' + beat.cover + '" duration="' + beat.duration + '" isGold="' + beat.isGold + '">'
                                        html += '<img src="{% static 'images/play.png' %}" alt=""> </div> </div>'
                                        html += '<div class="title-beat"> <p id="title-beat">' + beat.title + '</p> <span>' + beat.type + '</span> </div>'
                                        html += '<div class="parametrs-beat">'
                                        let isNew = beat.isNew
                                        if(isNew) {
                                            html += '<div class="beat-parametr new"> <p>NEW</p> </div>'
                                        }

                                        let isGold = beat.isGold
                                        if(isGold){
                                            html += '<div class="beat-parametr premium"><p>Gold</p></div>'
                                        }
                                        html += '<div class="beat-parametr"> <p>' + beat.tonal + '</p> </div> <div class="beat-parametr"> <p>' + beat.bpm + ' bpm</p> </div> <div class="beat-parametr"> <p>' + beat.mood + '</p> </div>  </div>'
                                        html += '<div class="beat-elements"> <div class="beat-price"> <p>$' + beat.price + '</p> </div>'

                                        html += '<div class="button-to-card">';
                                        if (beat.isAddedToCart) {
                                            html += '<button id="delete-from-cart" beat_id="' + beat.beat_id + '">ADDED✓</button>';
                                        } else {
                                            html += '<button id="add-to-cart" beat_id="' + beat.beat_id + '">ADD TO CART</button>';
                                        }
                                        html += '</div></div></div>';
                                    })
                                    $('.beat-items-container').html(html)
                                }
                          })
                      })
                    }
                </script>

                <div class="ranges-filter">
                <div class="bpm-filter">
                    <div class="title-filter">
                        <p>Price</p>
                    </div>
                    <div class="filter-range-content">
                        <div class="dropdown-menu2">
                            <button class="dropbtn2"><span class="rng-min2" id="rng-min2">{{ min_price }} $</span> - <span
                                    class="rng-max2">{{ max_price }} $</span>🢓</button>
                            <div class="dropdown-content2">
                                <div class="rangeslider">
                                    <input class="min2" name="range_1" type="range" min="{{ min_price }}" max="{{ max_price }}" value="0" />
                                    <input class="max2" name="range_1" type="range" min="{{ min_price }}" max="{{ max_price }}" value="{{ max_price }}" />
                                    <span class="range_min2 light left">{{ min_price }} $</span>
                                    <span class="range_max2 light right">{{ max_price }} $</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="bpm-filter">
                    <div class="title-filter">
                        <p>Bpm</p>
                    </div>
                    <div class="filter-range-content">
                        <div class="dropdown-menu2">
                            <button class="dropbtn2"><span class="rng-min">{{ min_bpm }} bpm</span> - <span class="rng-max">{{ max_bpm }} bpm</span>🢓</button>
                            <div class="dropdown-content2">
                                <div class="rangeslider">
                                    <input class="min" name="range_2" type="range" min="{{ min_bpm }}" max="{{ max_bpm }}" value="0" />
                                    <input class="max" name="range_2" type="range" min="{{ min_bpm }}" max="{{ max_bpm }}" value="200" />
                                    <span class="range_min light left">{{ min_bpm }} bpm</span>
                                    <span class="range_max light right">{{ max_bpm }} bpm</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


                <!-- <script>


                    // Обработчик события изменения значения фильтра Bpm
                    $('.ranges-filter input[name="range_2"]').on('input', function() {
                        let minBpm = $('.ranges-filter .min').val();
                        let maxBpm = $('.ranges-filter .max').val();

                        $.ajax({
                            url: '{% url 'filter' %}',
                            type: 'POST',
                            dataType: 'json',
                            data: {
                                'filterType': 'bpm',
                                'filterValue': {
                                    'min': minBpm,
                                    'max': maxBpm
                                }
                            },
                            success: function(response) {
                                html = ''
                                    response.beats.forEach(function (beat) {
                                        html += '<div class="beat-item"> <div class="beat-img"> <img class="beat-img-cls" src="' + beat.cover + '" alt="">'
                                        html += '<div id="play-beat-container" class="play-beat-container" beat_id="' + beat.beat_id + '" beat="' + beat.beat + '" title="' + beat.title + '" cover="' + beat.cover + '" duration="' + beat.duration + '" isGold="' + beat.isGold + '">'
                                        html += '<img src="{% static 'images/play.png' %}" alt=""> </div> </div>'
                                        html += '<div class="title-beat"> <p id="title-beat">' + beat.title + '</p> <span>' + beat.type + '</span> </div>'
                                        html += '<div class="parametrs-beat">'

                                        let isNew = beat.isNew
                                        if(isNew) {
                                            html += '<div class="beat-parametr new"> <p>NEW</p> </div>'
                                        }

                                        let isGold = beat.isGold
                                        if(isGold){
                                            html += '<div class="beat-parametr premium"><p>Gold</p></div>'
                                        }
                                        html += '<div class="beat-parametr"> <p>' + beat.tonal + '</p> </div> <div class="beat-parametr"> <p>' + beat.bpm + ' bpm</p> </div> <div class="beat-parametr"> <p>' + beat.mood + '</p> </div>  </div>'
                                        html += '<div class="beat-elements"> <div class="beat-price"> <p>$' + beat.price + '</p> </div>'

                                        html += '<div class="button-to-card">';
                                        if (beat.isAddedToCart) {
                                            html += '<button id="delete-from-cart" beat_id="' + beat.beat_id + '">ADDED✓</button>';
                                        } else {
                                            html += '<button id="add-to-cart" beat_id="' + beat.beat_id + '">ADD TO CART</button>';
                                        }
                                        html += '</div></div></div>';
                                    })
                                    $('.beat-items-container').html(html)
                            }
                        });
                    });
                </script> -->

                <div class="search-filter" data-filter-type="search">
                    <div class="title-filter">
                        <p>search</p>
                    </div>
                    <div class="search-filter-content">
                        <img src="{% static 'images/search.png' %}" alt="">
                        <input type="text" id="search-input">
                    </div>
                </div>
                <script>
                    $('#search-input').on('input', function() {
                        let parentMenu = this.closest(".search-filter");
                        let filterType = parentMenu.getAttribute("data-filter-type");
                        let searchQuery = document.getElementById("search-input").value;

                        $.ajax({
                                url: '{% url 'filter' %}',
                                type: 'POST',
                                dataType: 'json',
                                data: {
                                    'filterType': filterType,
                                    'filterValue': searchQuery
                                },
                                success: function (response) {
                                    let html = ''
                                    response.beats.forEach(function (beat) {
                                        html += '<div class="beat-item"> <div class="beat-img"> <img class="beat-img-cls" src="' + beat.cover + '" alt="">'
                                        html += '<div id="play-beat-container" class="play-beat-container" beat_id="' + beat.beat_id + '" beat="' + beat.beat + '" title="' + beat.title + '" cover="' + beat.cover + '" duration="' + beat.duration + '" isGold="' + beat.isGold + '">'
                                        html += '<img src="{% static 'images/play.png' %}" alt=""> </div> </div>'
                                        html += '<div class="title-beat"> <p id="title-beat">' + beat.title + '</p> <span>' + beat.type + '</span> </div>'
                                        html += '<div class="parametrs-beat">'

                                        let isNew = beat.isNew
                                        if(isNew) {
                                            html += '<div class="beat-parametr new"> <p>NEW</p> </div>'
                                        }

                                        let isGold = beat.isGold
                                        if(isGold){
                                            html += '<div class="beat-parametr premium"><p>Gold</p></div>'
                                        }
                                        html += '<div class="beat-parametr"> <p>' + beat.tonal + '</p> </div> <div class="beat-parametr"> <p>' + beat.bpm + ' bpm</p> </div> <div class="beat-parametr"> <p>' + beat.mood + '</p> </div>  </div>'
                                        html += '<div class="beat-elements"> <div class="beat-price"> <p>$' + beat.price + '</p> </div>'

                                        html += '<div class="button-to-card">';
                                        if (beat.isAddedToCart) {
                                            html += '<button id="delete-from-cart" beat_id="' + beat.beat_id + '">ADDED✓</button>';
                                        } else {
                                            html += '<button id="add-to-cart" beat_id="' + beat.beat_id + '">ADD TO CART</button>';
                                        }
                                        html += '</div></div></div>';
                                    })
                                    $('.beat-items-container').html(html)

                                    html = '';
                                    response.beats.forEach(function (beat) {
                                        html += '<div class="mobile-beat-item">';
                                        html += '<div class="mobile-beat-image-container">';
                                        html += '<img src="' + beat.cover + '" alt="">';
                                        html += '<div class="play-beat-container" beat_id="' + beat.beat_id + '" beat="' + beat.beat + '" title="' + beat.title + '" cover="' + beat.cover + '" duration="' + beat.duration + '" download="' + beat.beat + '">';
                                        html += '<img src="{% static 'images/play.png' %}" alt=""></div></div>';
                                        html += '<div class="mobile-beat-text">';
                                        html += '<div class="mobile-beat-text__up">';
                                        html += '<p>' + beat.title + ' <span>| ' + beat.type + '</span></p></div>';
                                        html += '<div class="mobile-beat-text__bottom">';
                                        html += '<div class="parametrs-beat">';

                                        if (beat.isNew) {
                                            html += '<div class="beat-parametr new"><p>NEW</p></div>';
                                        }

                                        if (beat.isGold) {
                                            html += '<div class="beat-parametr premium"><p>Gold</p></div>';
                                        }

                                        html += '<div class="beat-parametr"><p>' + beat.tonal + '</p></div>';
                                        html += '<div class="beat-parametr"><p>' + beat.bpm + ' bpm</p></div>';
                                        html += '<div class="beat-parametr"><p>' + beat.mood + '</p></div>';
                                        html += '</div></div></div>';
                                        html += '<div class="mobile-beat__to-card-container">';
                                        html += '<div class="to-card-block">';
                                        html += '<p>' + beat.price + '$</p>';
                                        html += '<div class="mobile-add-to-cart-btn">';

                                        if (beat.isAddedToCart) {
                                            html += '<button id="delete-from-cart" beat_id="' + beat.beat_id + '">ADDED✓</button>';
                                        } else {
                                            html += '<button id="add-to-cart" beat_id="' + beat.beat_id + '">ADD TO CARD</button>';
                                        }

                                        html += '</div></div></div></div>';
                                    });

                                    $('.mobile-beats-container').html(html);
                                }
                        })
                    })
                </script>

                <div class="mobile-filter">
                    <img src="{% static 'images/filter.png' %}" alt="" onclick="viewFilter()">
                </div>
            </div>
            <div class="bottom-filter">
                <div class="title-filter">
                    <p>GENRES</p>
                </div>
                <div class="filter-content" data-filter-type="genres">
                    <button class="scale button-active" id="button-main" onclick="changeColorGenre(this)" data-filter-value="all">ALL</button>
                    {% for genre in genre %}
                        <button class="scale" id="button" onclick="changeColorGenre(this)" data-filter-value="{{ genre.id }}">{{ genre.title }}</button>
                    {% endfor %}
                    <p class="scale reset-button" data-filter-type="reset">Reset</p>
                </div>
            </div>
            <script>
                $('body').on('click', '#button, #button-main', function(event) {
                    let filterType = 'genres';
                    let filterValue = this.getAttribute("data-filter-value");

                    $.ajax({
                            url: '{% url 'filter' %}',
                            type: 'POST',
                            dataType: 'json',
                            data: {
                                'filterType': filterType,
                                'filterValue': filterValue
                            },
                            success: function (response) {
                                html = ''
                                response.beats.forEach(function (beat) {
                                    html += '<div class="beat-item"> <div class="beat-img"> <img class="beat-img-cls" src="' + beat.cover + '" alt="">'
                                    html += '<div id="play-beat-container" class="play-beat-container" beat_id="' + beat.beat_id + '" beat="' + beat.beat + '" title="' + beat.title + '" cover="' + beat.cover + '" duration="' + beat.duration + '" isGold="' + beat.isGold + '">'
                                    html += '<img src="{% static 'images/play.png' %}" alt=""> </div> </div>'
                                    html += '<div class="title-beat"> <p id="title-beat">' + beat.title + '</p> <span>' + beat.type + '</span> </div>'
                                    html += '<div class="parametrs-beat">'

                                    let isNew = beat.isNew
                                    if(isNew) {
                                        html += '<div class="beat-parametr new"> <p>NEW</p> </div>'
                                    }

                                    let isGold = beat.isGold
                                    if(isGold){
                                        html += '<div class="beat-parametr premium"><p>Gold</p></div>'
                                    }
                                    html += '<div class="beat-parametr"> <p>' + beat.tonal + '</p> </div> <div class="beat-parametr"> <p>' + beat.bpm + ' bpm</p> </div> <div class="beat-parametr"> <p>' + beat.mood + '</p> </div>  </div>'
                                    html += '<div class="beat-elements"> <div class="beat-price"> <p>$' + beat.price + '</p> </div>'

                                    html += '<div class="button-to-card">';
                                    if (beat.isAddedToCart) {
                                        html += '<button id="delete-from-cart" beat_id="' + beat.beat_id + '">ADDED✓</button>';
                                    } else {
                                        html += '<button id="add-to-cart" beat_id="' + beat.beat_id + '">ADD TO CART</button>';
                                    }
                                    html += '</div></div></div>';
                                })
                                $('.beat-items-container').html(html)
                            }
                        })
                    })

                $('body').on('click', '.reset-button', function (event){
                    event.preventDefault()
                    let filterType = this.getAttribute("data-filter-type");

                    document.getElementById("search-input").value = ''

                   const buttons = document.querySelectorAll('.button-active');

                    buttons.forEach(button => {
                      button.classList.remove('button-active');
                    });

                    const buttonMain = document.querySelectorAll('#button-main');
                    buttonMain.forEach(buttons => {
                      buttons.classList.toggle('button-active');
                    });

                    const buttonMain1 = document.querySelectorAll('#button-main1');
                    buttonMain1.forEach(buttons => {
                      buttons.classList.toggle('button-active');
                    });

                    $.ajax({
                        url: '{% url 'filter' %}',
                        type: 'POST',
                        dataType: 'json',
                        data: {
                            'filterType': filterType,
                        },
                        success: function (response) {
                            html = ''
                            response.beats.forEach(function (beat) {
                                html += '<div class="beat-item"> <div class="beat-img"> <img class="beat-img-cls" src="' + beat.cover + '" alt="">'
                                html += '<div id="play-beat-container" class="play-beat-container" beat_id="' + beat.beat_id + '" beat="' + beat.beat + '" title="' + beat.title + '" cover="' + beat.cover + '" duration="' + beat.duration + '" isGold="' + beat.isGold + '">'
                                html += '<img src="{% static 'images/play.png' %}" alt=""> </div> </div>'
                                html += '<div class="title-beat"> <p id="title-beat">' + beat.title + '</p> <span>' + beat.type + '</span> </div>'
                                html += '<div class="parametrs-beat">'

                                let isNew = beat.isNew
                                if(isNew) {
                                    html += '<div class="beat-parametr new"> <p>NEW</p> </div>'
                                }

                                let isGold = beat.isGold
                                if(isGold){
                                    html += '<div class="beat-parametr premium"><p>Gold</p></div>'
                                }
                                html += '<div class="beat-parametr"> <p>' + beat.tonal + '</p> </div> <div class="beat-parametr"> <p>' + beat.bpm + ' bpm</p> </div> <div class="beat-parametr"> <p>' + beat.mood + '</p> </div>  </div>'
                                html += '<div class="beat-elements"> <div class="beat-price"> <p>$' + beat.price + '</p> </div>'

                                html += '<div class="button-to-card">';
                                if (beat.isAddedToCart) {
                                    html += '<button id="delete-from-cart" beat_id="' + beat.beat_id + '">ADDED✓</button>';
                                } else {
                                    html += '<button id="add-to-cart" beat_id="' + beat.beat_id + '">ADD TO CART</button>';
                                }
                                html += '</div></div></div>';
                            })
                            $('.beat-items-container').html(html)
                        }
                    })
                })
            </script>
            <div class="playlist-container">
                <div class="all-right-container">
                    <p>All rights belong to "AnsiantBeats"</p>
                </div>
                <div class="limit-beats-container">
                    <div class="beat-items-container">
                        {% for beat in beat %}
                            {% if beat.isPlaylist == True %}
                                <div class="beat-item">
                                    <div class="beat-img">
                                        <img class="beat-img-cls" src="{{ beat.cover }}" alt="">
                                        <div id="play-beat-container" class="play-beat-container" beat_id="{{ beat.beat_id }}" beat="{{ beat.beat }}" title="{{ beat.title }}" cover="{{ beat.cover }}" duration="{{ beat.duration }}" download="{{ beat.beat }}">
                                            <img src="{% static 'images/play.png' %}" alt="">
                                        </div>
                                    </div>
                                    <div class="title-beat">
                                        <p id="title-beat">{{ beat.title }}</p>
                                        <span>{{ beat.type }}</span>
                                    </div>
                                    <div class="parametrs-beat">
                                        {% if beat.isNew == True %}
                                            <div class="beat-parametr new">
                                                <p>NEW</p>
                                            </div>
                                        {% endif %}
                                        {% if beat.isGold == True %}
                                            <div class="beat-parametr premium">
                                                    <p>Gold</p>
                                            </div>
                                        {% endif %}
                                        <div class="beat-parametr">
                                            <p>{{ beat.tonal }}</p>
                                        </div>
                                        <div class="beat-parametr">
                                            <p>{{ beat.bpm }} bpm</p>
                                        </div>
                                        <div class="beat-parametr">
                                            <p>{{ beat.mood }}</p>
                                        </div>
                                    </div>
                                    <div class="beat-elements">
                                        <div class="beat-price">
                                            <p>
                                                ${{ beat.basic_price }}
                                            </p>
                                        </div>
                                        <div class="button-to-card">
                                            {% if beat.beat_id|stringformat:'s' in cart.keys %}
                                                    <button id="delete-from-cart" beat_id="{{ beat.beat_id }}">ADDED✓</button>
                                            {% else %}
                                                <button id="add-to-cart" beat_id="{{ beat.beat_id }}">ADD TO CARD</button>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            {% endif %}
                        {% endfor %}
                    </div>
                    <script>
                        $('body').on('click', '#add-to-cart', function (event){
                            event.preventDefault()
                            let beat_id = $(this).attr('beat_id')
                            $.ajax({
                                url: '{% url 'add_to_cart' %}',
                                type: 'POST',
                                dataType: 'json',
                                data: {
                                    'beat_id': beat_id
                                },
                                success: function (response) {
                                    if(response.success){
                                        $.get('{% url 'get_cart' %}', function(data) {
                                            let products = JSON.parse(data);
                                            let amount = 0
                                            let html = ''
                                            let isMatch = false
                                            for (let i = 0; i < products.length; i++) {
                                                amount += Number(products[i].price);
                                                if (String(beat_id) === String(products[i].id)) {
                                                    isMatch = true;
                                                }
                                            }

                                            let cartImageUrl = '{% static '/images/purchase2.png' %}';
                                            let shopCartUrl = '{% url 'shop_cart' %}';

                                            html += '<div class="header-cart-img"><img class="scale" src="' + cartImageUrl + '" alt="" onclick="window.location=\'' + shopCartUrl + '\'"></div>';
                                            html += '<div class="right-header-cart-text"> <p> $' + amount +'</p> </div>'
                                            $('.right-header-cart').html(html)
                                            html = '<button id="delete-from-cart" beat_id="' + beat_id + '">ADDED✓</button>'
                                            $(event.target).closest('.button-to-card').html(html)
                                            $(event.target).closest('.mobile-add-to-cart-btn').html(html)

                                            if($('#player-add-to-cart').attr('beat_id') === beat_id){
                                                html = '<button id="player-delete-from-cart" beat_id="' + beat_id + '">ADDED✓</button>';
                                                $('#player-button-cart').html(html);
                                            }
                                        })
                                    }
                                },
                                error: function(response){
                                    alert(response.e)
                                }
                            })
                        })

                        $('body').on('click', '#delete-from-cart', function (event){
                            event.preventDefault()
                            let beat_id = $(this).attr('beat_id')

                            $.ajax({
                                url: '{% url 'delete_item' %}',
                                type: 'POST',
                                dataType: 'json',
                                data: {
                                    'beat_id': beat_id
                                },
                                success: function (response){
                                    if(response.success) {
                                        $.get('{% url 'get_cart' %}', function(data) {
                                            let products = JSON.parse(data);
                                            let amount = 0
                                            let html = ''
                                            let isMatch = false
                                            for (let i = 0; i < products.length; i++) {
                                                amount += Number(products[i].price);
                                                if (String(beat_id) === String(products[i].id)) {
                                                    isMatch = true;
                                                }
                                            }

                                            let shopCartUrl = '{% url 'shop_cart' %}';

                                            html += '<div class="header-cart-img"><img class="scale" src="{% static 'images/purchase2.png' %}" alt="" onclick="window.location=\'' + shopCartUrl + '\'"></div> <div class="right-header-cart-text"> <p> $' + amount +'</p> </div>'
                                            $('.right-header-cart').html(html)
                                            html = '<button id="add-to-cart" beat_id="' + beat_id + '">ADD TO CARD</button>'
                                            $(event.target).closest('.button-to-card').html(html)
                                            $(event.target).closest('.mobile-add-to-cart-btn').html(html)

                                            if($('#player-delete-from-cart').attr('beat_id') === beat_id){
                                                html = '<button id="player-add-to-cart" beat_id="' + beat_id + '">ADD TO CART</button>';
                                                $('#player-button-cart').html(html);
                                            }
                                        })
                                    }
                                    else{
                                        alert('Error')
                                    }
                                }
                        })})
                    </script>
                    <div class="mobile-beats-container">
                        {% for beat in beat %}
                            <div class="mobile-beat-item">
                                <div class="mobile-beat-image-container">
                                    <img src="{{ beat.cover }}" alt="">
                                        <div class="play-beat-container" beat_id="{{ beat.beat_id }}" beat="{{ beat.beat }}" title="{{ beat.title }}" cover="{{ beat.cover }}" duration="{{ beat.duration }}" download="{{ beat.beat }}">
                                            <img src="{% static 'images/play.png' %}" alt="">
                                        </div>
                                </div>

                                <div class="mobile-beat-text">
                                    <div class="mobile-beat-text__up">
                                        <p>{{ beat.title }} <span>| {{ beat.type }}</span></p>
                                    </div>
                                    <div class="mobile-beat-text__bottom">
                                        <div class="parametrs-beat">
                                            <div class="beat-parametr new">
                                                <p>NEW</p>
                                            </div>
                                            {% if beat.isGold == True %}
                                                <div class="beat-parametr premium">
                                                        <p>Gold</p>
                                                </div>
                                            {% endif %}
                                            <div class="beat-parametr">
                                                <p>{{ beat.tonal }}</p>
                                            </div>
                                            <div class="beat-parametr">
                                                <p>{{ beat.bpm }} bpm</p>
                                            </div>
                                            <div class="beat-parametr">
                                                <p>{{ beat.mood }}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mobile-beat__to-card-container">
                                    <div class="to-card-block">
                                        <p>
                                            {{ beat.price }}$
                                        </p>
                                        <div class="mobile-add-to-cart-btn">
                                            {% if beat.beat_id|stringformat:'s' in cart.keys %}
                                                    <button id="delete-from-cart" beat_id="{{ beat.beat_id }}">ADDED✓</button>
                                            {% else %}
                                                <button id="add-to-cart" beat_id="{{ beat.beat_id }}">ADD TO CARD</button>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <div class="player" id="player">
            <img id="beat-cover" class="beat-cover" src="">
            <div class="right">
                <div class="top">
                    <a class="song" id="song"></a>
                    <a class="artist">
                        AnsiantBeats</a>
                </div>
                <div class="bottom">
                    <div class="audio-player">
                        <input id="range" type="range" style="height: 5px; border-radius: 5px;" >
                        <div class="controls">
                          <div class="play-container">
                            <div id="toggle-play" class="toggle-play play">
                          </div>
                          </div>
                          <div class="volume-container">
                            <div class="volume-button">
                              <div class="volume icono-volumeMedium"></div>
                            </div>

                            <input type="range" id="volume-input" min="0" max="1" step="0.1" value="1">
                          </div>

                            <a href="" id="beat-download"><img src="{% static 'images/download.png' %}" alt=""></a>

                          <div class="time">
                            <div id="current" class="current">0:00</div>
                            <div class="divider">/</div>
                            <div id="length" class="length">0:00</div>
                          </div>
                        </div>
                      </div>
                </div>
            </div>

            <div id="player-button-cart" class="button-to-card player-button">
{#                <button id="player-add-to-cart" beat_id="">ADD TO CART</button>#}
            </div>
        </div>
        <audio hidden id="google-player" controls>
            <source src="" type="audio/mp3">
        </audio>
        <script>
            let player = document.querySelectorAll('.play-beat-container');
            let audioElement = document.getElementById('google-player');

            if (audioElement.src === '') {
                document.getElementById('player').style.display = 'none';
            }

            player.forEach(function(element) {
                element.addEventListener('click', function(){
                    document.getElementById('player').style.display = 'flex';
                });
            });

            function viewFilter() {
                let menu = document.getElementById("filter-menu");
                if (getComputedStyle(menu).getPropertyValue("display") === 'none') {
                    menu.style.display = "block";
                }
                else {
                    menu.style.display = "none";
                }
            }
        </script>
    </div>
    <script type="text/javascript" src="/js/index.js"></script>

    <script>
        $('body').on('click', '.play-beat-container, .mobile-beat-image-container', function(event) {
            event.preventDefault();
            document.getElementById('google-player').src = $(this).attr('beat')
        })
    </script>
    <script>
        const audioPlayer = document.getElementById('google-player');
        const playButton = document.getElementById('toggle-play');
        const rangeInput = document.getElementById('range');
        const currentTimeSpan = document.getElementById('current');

        $('body').on('click', '#play-beat-container, .mobile-beat-image-container', function(event) {
            event.preventDefault();
            document.getElementById('beat-cover').src = $(this).attr('cover')
            document.getElementById('song').innerText = $(this).attr('title')
            document.getElementById('length').innerText = $(this).attr('duration')
            document.getElementById('beat-download').href = $(this).attr('download')

            let html = ''

            if ($(this).closest('.beat-item').find('#add-to-cart').attr('beat_id')) {
                if($(this).find('player-delete-from-cart')){
                    $('#player-delete-from-cart').data('beat_id', $(this).attr('beat_id'));
                    html = '<button id="player-add-to-cart" beat_id="' + $(this).attr('beat_id') + '">ADD TO CART</button>';
                    $('#player-button-cart').html(html);
                }
                else if($(this).find('player-add-to-cart')){
                    $('#player-add-to-cart').data('beat_id', $(this).attr('beat_id'));
                }
            }
            if ($(this).closest('.beat-item').find('#delete-from-cart').attr('beat_id')) {
                if($(this).find('player-add-to-cart')){
                    $('#player-add-to-cart').data('beat_id', $(this).attr('beat_id'));
                    html = '<button id="player-delete-from-cart" beat_id="' + $(this).attr('beat_id') + '">ADDED✓</button>';
                    $('#player-button-cart').html(html);
                }
                else if($(this).find('player-delete-from-cart')){
                    $('#player-delete-from-cart').data('beat_id', $(this).attr('beat_id'));
                }
            }


            audioPlayer.play()
            playButton.classList.remove('play');
            playButton.classList.add('pause');
        });


        playButton.addEventListener('click', function() {
            if (audioPlayer.paused) {
                audioPlayer.play();
                playButton.classList.remove('play');
                playButton.classList.add('pause');
            } else {
                audioPlayer.pause();
                playButton.classList.remove('pause');
                playButton.classList.add('play');
            }
        });

        const volumeInput = document.getElementById('volume-input');
        volumeInput.addEventListener('input', function() {
            const volume = parseFloat(volumeInput.value);
            audioPlayer.volume = volume;
        });

        audioPlayer.addEventListener('timeupdate', function() {
            const currentTime = audioPlayer.currentTime;
            const duration = audioPlayer.duration;
            const progress = (currentTime / duration) * 100;
            rangeInput.value = progress;
        });

        function updateAudioTime() {
          audioPlayer.currentTime = (rangeInput.value / 100) * audioPlayer.duration;
        }

        audioPlayer.addEventListener('timeupdate', function() {
            const currentTime = (rangeInput.value / 100) * audioPlayer.duration;
            if (currentTime >= audioPlayer.duration) {
                playButton.classList.remove('pause');
                playButton.classList.add('play');
            }
        });

        rangeInput.addEventListener('input', updateAudioTime);

        audioPlayer.addEventListener('timeupdate', function() {
            const currentTime = audioPlayer.currentTime;
            const minutes = Math.floor(currentTime / 60);
            const seconds = Math.floor(currentTime % 60);
            currentTimeSpan.textContent = (minutes < 10 ? '0' : '') + minutes + ':' + (seconds < 10 ? '0' : '') + seconds;
        });

        $('body').on('click', '#player-add-to-cart', function (event) {
            event.preventDefault()
            let beat_id = $(this).attr('beat_id')
            let addButton = document.querySelector('button#add-to-cart[beat_id="' + beat_id + '"]');
            let parentElement = $(addButton).parent();

            $.ajax({
                url: '{% url 'add_to_cart' %}',
                type: 'POST',
                dataType: 'json',
                data: {
                    'beat_id': beat_id
                },
                success: function (response) {
                    if(response.success){
                        $.get('{% url 'get_cart' %}', function(data) {
                            let products = JSON.parse(data);
                            let amount = 0
                            let html = ''
                            let isMatch = false
                            for (let i = 0; i < products.length; i++) {
                                amount += Number(products[i].price);
                                if (String(beat_id) === String(products[i].id)) {
                                    isMatch = true;
                                }
                            }
                            html = '<div class="header-cart-img"><img class="scale" src="{% static 'images/purchase2.png' %}" alt="" onclick="window.location=\{% url 'shop_cart' %}\"> </div> <div class="right-header-cart-text"> <p> $' + amount +'</p> </div>'
                            $('.right-header-cart').html(html)
                            html = '<button id="player-delete-from-cart" beat_id="' + beat_id + '">ADDED✓</button>'
                            $('#player-button-cart').html(html)
                            html = '<button id="delete-from-cart" beat_id="' + beat_id + '">ADDED✓</button>'
                            parentElement.html(html)
                        })
                    }
                },
                error: function(response){
                    alert(response.e)
                }
            })
        })

        $('body').on('click', '#player-delete-from-cart', function (event){
            event.preventDefault()
            let beat_id = $(this).attr('beat_id')
            let addButton = document.querySelector('button#delete-from-cart[beat_id="' + beat_id + '"]');
            let parentElement = $(addButton).parent();

            $.ajax({
                url: '{% url 'delete_item' %}',
                type: 'POST',
                dataType: 'json',
                data: {
                    'beat_id': beat_id
                },
                success: function (response){
                    if(response.success) {
                        $.get('{% url 'get_cart' %}', function(data) {
                            let products = JSON.parse(data);
                            let amount = 0
                            let html = ''
                            let isMatch = false
                            for (let i = 0; i < products.length; i++) {
                                amount += Number(products[i].price);
                                if (String(beat_id) === String(products[i].id)) {
                                    isMatch = true;
                                }
                            }
                            html = '<div class="header-cart-img"><img class="scale" src="{% static 'images/purchase2.png' %}" alt="" onclick="window.location=\{% url 'shop_cart' %}\"> </div> <div class="right-header-cart-text"> <p> $' + amount +'</p> </div>'
                            html = '<div class="header-cart-img"><img class="scale" src="{% static 'images/purchase2.png' %}" alt="" onclick="window.location=\{% url 'shop_cart' %}\"> </div> <div class="right-header-cart-text"> <p> $' + amount +'</p> </div>'
                            $('.right-header-cart').html(html)
                            html = '<button id="player-add-to-cart" beat_id="' + beat_id + '">ADD TO CART</button>'
                            $('#player-button-cart').html(html)
                            html = '<button id="add-to-cart" beat_id="' + beat_id + '">ADD TO CART</button>'
                            parentElement.html(html)
                        })
                    }
                    else{
                        alert('Error')
                    }
                }
        })})
    </script>
</body>
<script>
    document.addEventListener("DOMContentLoaded", function() {
      let googlePlayer = document.getElementById('google-player');
      googlePlayer.play();
    });
</script>
<script>
        function changeColorFilter(filterObj){
            filterObj.classList.toggle("button-active");
            if(filterObj.textContent == "ALL"){
                var elms = document.querySelectorAll("[id='button1']");

                for(var i = 0; i < elms.length; i++)
                    elms[i].classList.remove("button-active");
            }
            else{
                var elms = document.querySelectorAll("[id='button-main1']");

                for(var i = 0; i < elms.length; i++)
                    elms[i].classList.remove("button-active");
            }
        }

        function changeColorGenre(filterObj){
            filterObj.classList.toggle("button-active");
            if(filterObj.textContent == "ALL"){
                var elms = document.querySelectorAll("[id='button']");

                for(var i = 0; i < elms.length; i++)
                    elms[i].classList.remove("button-active");
            }
            else{
                var elms = document.querySelectorAll("[id='button-main']");

                for(var i = 0; i < elms.length; i++)
                    elms[i].classList.remove("button-active");
            }
        }
</script>

<script>
    (function () {
        function addSeparator(nStr) {
            nStr += '';
            var x = nStr.split('.');
            var x1 = x[0];
            var x2 = x.length > 1 ? '.' + x[1] : '';
            var rgx = /(\d+)(\d{3})/;
            while (rgx.test(x1)) {
                x1 = x1.replace(rgx, '$1' + '.' + '$2');
            }
            return x1 + x2;
        }

        function rangeInputChangeEventHandler(e) {
            var rangeGroup = $(this).attr('name');
            var minBtn = $(this).parent().find('.min');
            var maxBtn = $(this).parent().find('.max');
            var range_min = $(this).parent().find('.range_min');
            var range_max = $(this).parent().find('.range_max');
            let minVal = parseInt($(minBtn).val())
            let maxVal = parseInt($(maxBtn).val())
            var origin = $(this).context.className;

            $(range_min).html(minVal + ' bpm');
            $(range_max).html(maxVal + ' bpm');


            $('.ranges-filter input[name="range_2"]').on('change', function () {
                var minVal = parseInt($(this).parent().find('.min').val());
                var maxVal = parseInt($(this).parent().find('.max').val());

                $.ajax({
                    url: '{% url "filter" %}',
                    type: 'POST',
                    dataType: 'json',
                    data: {
                        'filterType': 'bpm',
                        'min': minVal,
                        'max': maxVal
                    },
                    success: function (response) {
                        var html = '';
                        response.beats.forEach(function (beat) {
                            html += '<div class="beat-item"> <div class="beat-img"> <img class="beat-img-cls" src="' + beat.cover + '" alt="">';
                            html += '<div id="play-beat-container" class="play-beat-container" beat_id="' + beat.beat_id + '" beat="' + beat.beat + '" title="' + beat.title + '" cover="' + beat.cover + '" duration="' + beat.duration + '" isGold="' + beat.isGold + '">';
                            html += '<img src="{% static "images/play.png" %}" alt=""> </div> </div>';
                            html += '<div class="title-beat"> <p id="title-beat">' + beat.title + '</p> <span>' + beat.type + '</span> </div>';
                            html += '<div class="parametrs-beat">';

                            var isNew = beat.isNew;
                            if (isNew) {
                                html += '<div class="beat-parametr new"> <p>NEW</p> </div>';
                            }

                            var isGold = beat.isGold;
                            if (isGold) {
                                html += '<div class="beat-parametr premium"><p>Gold</p></div>';
                            }
                            html += '<div class="beat-parametr"> <p>' + beat.tonal + '</p> </div> <div class="beat-parametr"> <p>' + beat.bpm + ' bpm</p> </div> <div class="beat-parametr"> <p>' + beat.mood + '</p> </div>  </div>'
                            html += '<div class="beat-elements"> <div class="beat-price"> <p>$' + beat.price + '</p> </div>';

                            html += '<div class="button-to-card">';
                            if (beat.isAddedToCart) {
                                html += '<button id="delete-from-cart" beat_id="' + beat.beat_id + '">ADDED✓</button>';
                            } else {
                                html += '<button id="add-to-cart" beat_id="' + beat.beat_id + '">ADD TO CART</button>';
                            }
                            html += '</div></div></div>';
                        })
                        $('.beat-items-container').html(html);
                    }
                })
            });

            if (origin === 'min' && minVal > maxVal - 5) {
                $(minBtn).val(maxVal - 5);
            }
            minVal = parseInt($(minBtn).val());
            $(range_min).html(minVal + ' bpm');

            if (origin === 'max' && maxVal - 5 < minVal) {
                $(maxBtn).val(5 + minVal);
            }
            maxVal = parseInt($(maxBtn).val());
            $(range_max).html(maxVal + ' bpm');

            if (minVal && maxVal) {
                var newText = $(range_min)[0];
                newText.innerHTML = minVal + ' bpm';

                newText = $(range_max)[0];
                newText.innerHTML = maxVal + ' bpm';
            } else if (minVal && !maxVal) {
                newText = $(range_min)[0];
                newText.innerHTML = minVal + ' bpm';

                newText = $(range_max)[0];
                newText.innerHTML = '∞';
            }
        }
        $('input[name="range_2"]').on('input', rangeInputChangeEventHandler);
    })();
</script>


<script>
    (function () {
        function addSeparator(nStr) {
            nStr += '';
            var x = nStr.split('.');
            var x1 = x[0];
            var x2 = x.length > 1 ? '.' + x[1] : '';
            var rgx = /(\d+)(\d{3})/;
            while (rgx.test(x1)) {
                x1 = x1.replace(rgx, '$1' + '.' + '$2');
            }
            return x1 + x2;
        }

        function rangeInputChangeEventHandler(e) {
            var rangeGroup = $(this).attr('name');
            var minBtn = $(this).parent().find('.min2');
            var maxBtn = $(this).parent().find('.max2');
            var range_min = $(this).parent().find('.range_min2');
            var range_max = $(this).parent().find('.range_max2');
            let minVal = parseInt($(minBtn).val())
            let maxVal = parseInt($(maxBtn).val())
            var origin = $(this).context.className;

            $(range_min).html(addSeparator(minVal) + ' $');
            $(range_max).html(addSeparator(maxVal) + ' $');

            $('.ranges-filter input[name="range_1"]').on('change', function () {
                var minVal = parseInt($(this).parent().find('.min2').val());
                var maxVal = parseInt($(this).parent().find('.max2').val());

                $.ajax({
                    url: '{% url "filter" %}',
                    type: 'POST',
                    dataType: 'json',
                    data: {
                        'filterType': 'price',
                        'min': minVal,
                        'max': maxVal
                    },
                    success: function (response) {
                        var html = '';
                        response.beats.forEach(function (beat) {
                            html += '<div class="beat-item"> <div class="beat-img"> <img class="beat-img-cls" src="' + beat.cover + '" alt="">';
                            html += '<div id="play-beat-container" class="play-beat-container" beat_id="' + beat.beat_id + '" beat="' + beat.beat + '" title="' + beat.title + '" cover="' + beat.cover + '" duration="' + beat.duration + '" isGold="' + beat.isGold + '">';
                            html += '<img src="{% static "images/play.png" %}" alt=""> </div> </div>';
                            html += '<div class="title-beat"> <p id="title-beat">' + beat.title + '</p> <span>' + beat.type + '</span> </div>';
                            html += '<div class="parametrs-beat">';

                            var isNew = beat.isNew;
                            if (isNew) {
                                html += '<div class="beat-parametr new"> <p>NEW</p> </div>';
                            }

                            var isGold = beat.isGold;
                            if (isGold) {
                                html += '<div class="beat-parametr premium"><p>Gold</p></div>';
                            }
                            html += '<div class="beat-parametr"> <p>' + beat.tonal + '</p> </div> <div class="beat-parametr"> <p>' + beat.bpm + ' bpm</p> </div> <div class="beat-parametr"> <p>' + beat.mood + '</p> </div>  </div>'
                            html += '<div class="beat-elements"> <div class="beat-price"> <p>$' + beat.price + '</p> </div>';

                            html += '<div class="button-to-card">';
                            if (beat.isAddedToCart) {
                                html += '<button id="delete-from-cart" beat_id="' + beat.beat_id + '">ADDED✓</button>';
                            } else {
                                html += '<button id="add-to-cart" beat_id="' + beat.beat_id + '">ADD TO CART</button>';
                            }
                            html += '</div></div></div>';
                        })
                        $('.beat-items-container').html(html);
                    }
                })
            });

            if (origin === 'min2' && minVal > maxVal - 5) {
                $(minBtn).val(maxVal - 5);
            }
            minVal = parseInt($(minBtn).val());
            $(range_min).html(addSeparator(minVal) + ' $');

            if (origin === 'max2' && maxVal - 5 < minVal) {
                $(maxBtn).val(5 + minVal);
            }
            maxVal = parseInt($(maxBtn).val());
            $(range_max).html(addSeparator(maxVal) + ' $');

            if (minVal && maxVal) {
                var newText = $(range_min)[0];
                newText.innerHTML = addSeparator(minVal) + ' $';

                newText = $(range_max)[0];
                newText.innerHTML = addSeparator(maxVal) + ' $';
            } else if (minVal && !maxVal) {
                newText = $(range_min)[0];
                newText.innerHTML = addSeparator(minVal) + ' $';

                newText = $(range_max)[0];
                newText.innerHTML = '∞';
            }
        }
        $('input[type="range"]').on('input', rangeInputChangeEventHandler);
    })();
</script>
<script>
    function viewMenu() {
        let menu = document.getElementById("menu");
        if (getComputedStyle(menu).getPropertyValue("display") === 'none') {
            menu.style.display = "block";
            document.getElementsByTagName("header").style.background = "#242424";
        }
        else {
            menu.style.display = "none";
        }
    }
</script>
</html>